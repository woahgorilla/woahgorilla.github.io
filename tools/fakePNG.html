<!DOCTYPE html>
<html>
    <head>
        <link rel="icon" type="images/x-icon" href="https://woahgorilla.github.io/favicon.ico">
        <meta name="keywords" content="fake png, fake transparent, fake, png, transparent, prank, javascript">
        <meta property="og:title" content="Fake transparent PNG maker">
        <meta property="og:site_name" content="Fake transparent PNG maker">
        <meta property="og:description" content="Make your PNG images into those fake ones with the squares in the background!">
        <meta name="description" content="Make your PNG images into those fake ones with the squares in the background!">
        <meta name="author" content="Ultracat39">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Fake PNG maker</title>
        <style>
            body {
                background-color: #2c3e50; 
                color: white; 
                font-family: sans-serif;
                margin: 0; 
                padding: 0; 
                display: flex; 
                flex-direction: column; 
                align-items: center; 
                justify-content: center;
                height: 100vh;
            }
            .hidden {
                display: none;
            }
            .title {
                font-size: 3.36vw;
            }
            .center {
                text-align: center;
                width: 56vw;
            }
            .box {
                text-align: center;
                padding: 0.7vw;
                margin-bottom: 0.7vw;
                border: 0.07vw solid #ecf0f1;
                border-radius: 0.35vw;
                font-size: 1.12vw;
                background-color: #34495e;
                color: white;
                width: 56vw;
            }
            input[type=file]::file-selector-button {
                border: solid;  
                cursor: pointer; 
                font-size: 1.12vw; 
                color: white;
                background-color: rgb(0, 255, 13);
                border-color: rgb(0, 208, 10);
                transition-duration: 0.3s; 
                border-radius: 0px; 
                padding: 0.35vw 0.35vw; 
                text-align: center; 
                text-decoration: none; 
                display: inline-block; 
                font-size: 1.12vw; 
                border-radius: 1.4vw; 
            }
    
            input[type=file]::file-selector-button:hover {
                background-color: rgb(0, 208, 10);
                border-color: rgb(0, 165, 8);
            }
            input[type='file'] {
                padding: 0.7vw;
                padding-top: 0;
                margin-bottom: 0.7vw;
                font-size: 1.12vw;
                color: white;
                width: 17vw;
            }
            button {
                padding: 0.7vw 1.05vw;
                border: solid;
                border-radius: 0.35vw;
                cursor: pointer;
                font-size: 1.12vw;
                transition:  0.3s;
                color: #ffffff;
            }
            #reset {cursor: pointer; 
                background-color: #ff0000; 
                border: solid; 
                border-radius: 0.35vw; 
                border-color: #c70000;
            }
            button#reset:hover {
                background-color: #d20404;
                border-color: #b50404;
            }
            #convert {
                background-color:#00ff17;
                border-color: #00c710;
            }
            #convert:hover {
                background-color:#00c710;
                border-color: #00a707;
            }
            select {
                background-color: #0dc1c1;
                color: #ffffff;
                border-radius: 0.35vw; 
                border: solid;
                border-color: #149e9e;
            }
            .slidecontainer {
                width: 100%;
            }
            .slider {

                border-radius: 0.35vw;
                -webkit-appearance: none;
                appearance: none;
                width: 20vw;
                height: 1.75vw;
                background: #8682b6;
                outline: none;
                opacity: 0.7;
                -webkit-transition: .3s;
                transition: opacity .3s;
                border: solid;
                border-color: #74709e;
            }
            .slider:hover {
                opacity: 1;
            }
            .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 1.75vw;
            height: 1.75vw;
            background: #056ab2;
            cursor: pointer;
            border-radius: 0.35vw; 
            border: solid;
            border-color: #045b9a;
            }

            .slider::-moz-range-thumb {
            width: 1.75vw; 
            height: 1.75vw; 
            background: #056ab2;
            cursor: pointer; 
            border-radius: 0.35vw; 
            border: solid;
            border-color: #045b9a
            }
        </style>
    </head>
    <body>
        <h1>Fake PNG Creater</h1>
        <div class="box">
            <p>
                <input type="file" id="fileInput" accept="image/png">
                <br>
                Download product as:
                <select id="convertTo">
                    <option value="png">PNG</option>
                    <option value="jpeg">JPEG/JPG</option>
                </select>
                <div class="slidecontainer">
                    <p id="pixelsDisplay">Pixels per square: 30</p>
                        <input type="range" min="1" max="100" value="30" class="slider" id="pixelsSlider">
                </div>
            </p>
            <p>
                <button id="reset">Clear</button>
                <button id="convert">Create</button>
            </p>
        </div>
        <h2>About</h2>
        <p class="center">Make your PNG images into those stupid fake ones you always see on google images with the background that's just a bunch of grey squares. Annoy people with these fake PNG thingies or something.</p>
        <div class="hidden">
            <a id="dummyDownloadLink"></a>
            <canvas id="canvas">your browser does not support canvas (which is needed for this to work)</canvas>
        </div>

        <script>
            let type;
            const fileInput = document.getElementById('fileInput');
            const canvas = document.getElementById('canvas');
            const convertButton = document.getElementById('convert');
            const resetButton = document.getElementById('reset');
            let ctx = canvas.getContext('2d');
            const imgTypeSelector = document.getElementById('convertTo');
            const squareSizeSlider = document.getElementById('pixelsSlider');
            const pixelsDisplay = document.getElementById('pixelsDisplay');
            convertButton.onclick = function() {
                type = imgTypeSelector.value;
                const files = fileInput.files;
                for (let i = 0; i < files.length; i++) {
                    const fileName = files[i].name.split('.')[0] + '.' + type;
                    window.createImageBitmap(files[i]).then(function (img) {
                        canvas.height = img.height;
                        canvas.width = img.width;
                        let squareGrey = true;
                        const squareSize = squareSizeSlider.value;
                        const squaresX = Math.ceil(canvas.width / squareSize);
                        const squaresY = Math.ceil(canvas.height / squareSize);
                        for (let i = 0; i < squaresX; i++) {
                            let x = i * squareSize;
                            for (let v = 0; v < squaresY; v++) {
                                let y = v * squareSize;
                                if (squareGrey) {
                                    ctx.fillStyle = '#cfcfcf';
                                } else {
                                    ctx.fillStyle = '#ffffff';
                                }
                                ctx.fillRect(x, y, squareSize, squareSize);
                                squareGrey = !squareGrey;
                            }
                            squareGrey = !squareGrey
                        }
                        ctx.drawImage(img, 0, 0);

                        downloadCanvasAsImage(fileName);
                    });
                   // img.then(processBitmap(img));
                }
            }
            
            function downloadCanvasAsImage(name){
                let canvasImage = canvas.toDataURL('image/'+type);
                let a = document.getElementById('dummyDownloadLink');

                let xhr = new XMLHttpRequest();
                xhr.responseType = 'blob';
                xhr.onload = function () {
                    a.href = window.URL.createObjectURL(xhr.response);
                    a.download = name;
                    a.click();
                };
                xhr.open('GET', canvasImage);
                xhr.send();
            }

            squareSizeSlider.onchange = function() {
                pixelsDisplay.innerText = 'Pixels per square: ' + squareSizeSlider.value
            }

            resetButton.onclick = function() {
                fileInput.value = null;
                squareSizeSlider.value = 30
                pixelsDisplay.innerText = 'Pixels per square: ' + squareSizeSlider.value
            }
        </script>
    </body>
</html>